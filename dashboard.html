<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⚡ Vajra Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Scrollbar  */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="bg-slate-900 text-slate-300 font-mono h-screen flex flex-col overflow-hidden">

    <header class="border-b border-slate-800 p-4 flex justify-between items-center bg-slate-950">
        <div class="flex items-center gap-3">
            <div class="h-3 w-3 rounded-full bg-green-500 animate-pulse"></div>
            <h1 class="text-xl font-bold tracking-wider text-white">VAJRA <span class="text-slate-500 text-sm font-normal">HFT ENGINE</span></h1>
        </div>
        <div class="text-right">
            <p class="text-xs text-slate-500 uppercase">Last Traded Price</p>
            <p id="ticker" class="text-3xl font-bold text-white transition-colors duration-200">Waiting...</p>
        </div>
    </header>

    <main class="grid grid-cols-1 md:grid-cols-3 gap-px bg-slate-800 flex-1 overflow-hidden">
        
        <div class="bg-slate-900 flex flex-col border-r border-slate-800">
            <div class="p-3 border-b border-slate-800 flex justify-between items-center sticky top-0 bg-slate-900 z-10">
                <h2 class="text-green-500 font-bold text-sm uppercase tracking-wide">Bids (Buy Orders)</h2>
                <span class="text-xs text-slate-500">Vol / Price</span>
            </div>
            <div id="bids-list" class="flex-1 overflow-y-auto p-2 space-y-1">
                </div>
        </div>

        <div class="bg-slate-900 flex flex-col border-r border-slate-800">
            <div class="p-3 border-b border-slate-800 flex justify-between items-center sticky top-0 bg-slate-900 z-10">
                <h2 class="text-red-500 font-bold text-sm uppercase tracking-wide">Asks (Sell Orders)</h2>
                <span class="text-xs text-slate-500">Vol / Price</span>
            </div>
            <div id="asks-list" class="flex-1 overflow-y-auto p-2 space-y-1">
                </div>
        </div>

        <div class="bg-slate-950 flex flex-col">
            <div class="p-3 border-b border-slate-800 sticky top-0 bg-slate-950 z-10">
                <h2 class="text-blue-400 font-bold text-sm uppercase tracking-wide">Trade Tape</h2>
            </div>
            <div id="trade-list" class="flex-1 overflow-y-auto p-2 space-y-1 font-mono text-xs">
                </div>
        </div>

    </main>

    <footer class="border-t border-slate-800 p-2 bg-slate-950 text-xs text-slate-600 flex justify-between">
        <span>● System Status: <span class="text-green-500">Operational</span></span>
        <span>Engine: <span class="text-white">Bun v1.0</span> | Latency: <span class="text-white">< 1ms</span></span>
    </footer>

    <script>
        // Keep the exact same logic, just generating different HTML classes
        async function fetchBook() {
            try {
                const res = await fetch("http://localhost:3000/book");
                const data = await res.json();

                // 1. Ticker Logic (Color change based on up/down could go here)
                if (data.trades.length > 0) {
                    const lastPrice = data.trades[0].price;
                    document.getElementById("ticker").innerText = `$${lastPrice}.00`;
                }

                // 2. Render Bids (Green Layout)
                document.getElementById("bids-list").innerHTML = data.bids.map((o, i) => {
                    // Visual depth bar trick using background gradient
                    const depth = Math.min(o.quantity * 10, 100); 
                    return `
                    <div class="flex justify-between items-center text-sm p-1 hover:bg-slate-800 cursor-pointer relative">
                        <div class="absolute right-0 top-0 bottom-0 bg-green-500/10" style="width: ${depth}%"></div>
                        <span class="text-slate-400 z-10 font-bold">${o.quantity}</span>
                        <span class="text-green-500 z-10">$${o.price}</span>
                    </div>
                `}).join('');

                // 3. Render Asks (Red Layout)
                document.getElementById("asks-list").innerHTML = data.asks.map(o => {
                    const depth = Math.min(o.quantity * 10, 100);
                    return `
                    <div class="flex justify-between items-center text-sm p-1 hover:bg-slate-800 cursor-pointer relative">
                        <div class="absolute right-0 top-0 bottom-0 bg-red-500/10" style="width: ${depth}%"></div>
                        <span class="text-slate-400 z-10 font-bold">${o.quantity}</span>
                        <span class="text-red-500 z-10">$${o.price}</span>
                    </div>
                `}).join('');

                // 4. Render Tape (Blue/White Layout)
                document.getElementById("trade-list").innerHTML = data.trades.map(t => `
                    <div class="flex justify-between text-slate-400 border-b border-slate-900 pb-1 mb-1">
                        <span class="opacity-50">${t.time}</span>
                        <span>
                            <span class="text-slate-200">${t.quantity} BTC</span> 
                            @ <span class="text-white font-bold">$${t.price}</span>
                        </span>
                    </div>
                `).join('');

            } catch (e) { console.error(e); }
        }

        // Poll at 100ms for smooth UI
        setInterval(fetchBook, 100);
    </script>
</body>
</html>